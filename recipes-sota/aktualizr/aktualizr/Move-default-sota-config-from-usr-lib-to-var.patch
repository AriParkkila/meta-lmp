From 348530cdd3f73764502eedcd0f588808d9f4e932 Mon Sep 17 00:00:00 2001
From: Ricardo Salveti <ricardo@opensourcefoundries.com>
Date: Wed, 9 May 2018 15:21:21 -0300
Subject: [PATCH] Make default config search for /var/sota by default

User can replace the configs via /usr/lib/sota/conf.d or
/usr/sota/conf.d if needed.

Signed-off-by: Ricardo Salveti <ricardo@opensourcefoundries.com>
---
 src/implicit_writer/main.cc      | 2 +-
 src/libaktualizr/config/config.h | 2 +-
 2 files changed, 2 insertions(+), 2 deletions(-)

diff --git a/src/implicit_writer/main.cc b/src/implicit_writer/main.cc
index 9bf6ef37..153cf75e 100644
--- a/src/implicit_writer/main.cc
+++ b/src/implicit_writer/main.cc
@@ -88,7 +88,7 @@ int main(int argc, char *argv[]) {
 
   if (!no_root) {
     boost::filesystem::path ca_path(prefix);
-    config.import.tls_cacert_path = "/usr/lib/sota/root.crt";
+    config.import.tls_cacert_path = "/var/sota/root.crt";
     ca_path /= config.import.tls_cacert_path;
 
     std::string server_ca = Bootstrap::readServerCa(credentials_path);
diff --git a/src/libaktualizr/config/config.h b/src/libaktualizr/config/config.h
index 681adba5..daaeb648 100644
--- a/src/libaktualizr/config/config.h
+++ b/src/libaktualizr/config/config.h
@@ -133,7 +133,7 @@ class Config {
   TelemetryConfig telemetry;
 
  private:
-  std::vector<boost::filesystem::path> config_dirs_ = {"/usr/lib/sota/conf.d", "/etc/sota/conf.d/"};
+  std::vector<boost::filesystem::path> config_dirs_ = {"/var/sota/sota.toml", "/usr/lib/sota/conf.d", "/etc/sota/conf.d/"};
   void updateFromDirs(const std::vector<boost::filesystem::path>& configs);
   void updateFromPropertyTree(const boost::property_tree::ptree& pt);
   void updateFromToml(const boost::filesystem::path& filename);
-- 
2.17.0

