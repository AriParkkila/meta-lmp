From 098917e7a35f8a1fe0ce2715df634b24d7fd36f4 Mon Sep 17 00:00:00 2001
From: Ricardo Salveti <ricardo@foundries.io>
Date: Mon, 16 Dec 2019 21:15:24 -0300
Subject: [PATCH] core_mmc: fix build warning when CFG_CORE_DYN_SHM=n

Signed-off-by: Ricardo Salveti <ricardo@foundries.io>
---
 core/arch/arm/mm/core_mmu.c    | 2 ++
 core/arch/arm/tee/entry_fast.c | 2 ++
 2 files changed, 4 insertions(+)

diff --git a/core/arch/arm/mm/core_mmu.c b/core/arch/arm/mm/core_mmu.c
index 7b304832..48eb35d3 100644
--- a/core/arch/arm/mm/core_mmu.c
+++ b/core/arch/arm/mm/core_mmu.c
@@ -257,6 +257,7 @@ static struct tee_mmap_region *find_map_by_pa(unsigned long pa)
 	return NULL;
 }
 
+#if defined(CFG_CORE_DYN_SHM) || defined(CFG_SECURE_DATA_PATH)
 static bool pbuf_is_special_mem(paddr_t pbuf, size_t len,
 				const struct core_mmu_phys_mem *start,
 				const struct core_mmu_phys_mem *end)
@@ -270,6 +271,7 @@ static bool pbuf_is_special_mem(paddr_t pbuf, size_t len,
 
 	return false;
 }
+#endif
 
 #ifdef CFG_CORE_DYN_SHM
 static void carve_out_phys_mem(struct core_mmu_phys_mem **mem, size_t *nelems,
diff --git a/core/arch/arm/tee/entry_fast.c b/core/arch/arm/tee/entry_fast.c
index 2d71d4cf..15e29c9a 100644
--- a/core/arch/arm/tee/entry_fast.c
+++ b/core/arch/arm/tee/entry_fast.c
@@ -64,6 +64,8 @@ static void tee_entry_exchange_capabilities(struct thread_smc_args *args)
 {
 	bool dyn_shm_en = false;
 
+	(void) dyn_shm_en;
+
 	/*
 	 * Currently we ignore OPTEE_SMC_NSEC_CAP_UNIPROCESSOR.
 	 *
-- 
2.24.1

